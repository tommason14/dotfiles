# NB: $ = shell command, ! = shell command and wait for user to enter
# $f = current file

set shell sh
set shellopts '-eu'

# Remove default mappings by leaving blank assignment
map d
map m
map p
map y
map n 

# Ranger-like
map yy copy
map dd cut
map pp paste
map dD delete
map dt $mv "$fx" ~/.trash # bin for accidental deletion
map <bs2> set hidden!

# Movement commands

map dk cd ~/Desktop
map dc cd ~/Documents
map dw cd ~/Downloads
map go cd /Volumes/GoogleDrive/My\ Drive
map gc cd /Volumes/GoogleDrive/My\ Drive/hydrated_ils
map dp cd ~/Documents/repos/dopamine/dopamine_paper
map mc cd ~/Documents/repos/mccg

# File opening
# maybe should use mime for this
map o. $open .
map ov $vim "$f"
map om $molden "$f"
map og $gmolden "$f"
map <enter> $open "$f" # default programs

# Shell utilities
map g2m $gamess_to_molden.py "$f"
map mx $chmod +x "$f"
map yc $cat "$f" | pbcopy
map moc $cat "$f" | awk '{OFS=","; print $1,$2}' > tmp && mv tmp "$f"

# utilities

map yq1 $yes "" | qcp -t1
map yq2 !qcp -t2
map yq3 $yes "" | qcp -t3

# fluorescence
map yqf $qcp_fluorescence
map yqfa $qcp_fluorescence_all
map pfl :/Volumes/GoogleDrive/My\ Drive/scripts/fluorescence/plot_uv_vis_last_iter.py -f "$f" 
# defaults
map pfd $/Volumes/GoogleDrive/My\ Drive/scripts/fluorescence/plot_uv_vis_last_iter.py -f "$f"
map pfn $/Volumes/GoogleDrive/My\ Drive/scripts/fluorescence/plot.gnuplot.sh "$f"
# trimmed
map pft $/Volumes/GoogleDrive/My\ Drive/scripts/fluorescence/plot_uv_vis_last_iter.py -f "$f" -l 180 -m 500

# plotting in gnuplot

# MP2
map pm !cat "$f" | grep 'E(MP2)' | sed '/NaN/d' | tr -s [:blank:] | cut -d ' ' -f 3 | gnuplot -e "set terminal dumb; plot '-' with lines notitle"
# FMO 
map pfo !cat "$f" | grep 'E corr MP2(2)=' | tr -s [:blank:] | cut -d ' ' -f 10 | gnuplot -e "set terminal dumb; plot '-' with lines notitle"
# Gaussian
map pg !cat "$f" | grep 'SCF Done' | tr -s [:blank:] | cut -d ' ' -f 6 | gnuplot -e "set terminal dumb; plot '-' with lines notitle"

# new files

cmd new_rmd ${{
  # write bach func to take in argument
  echo "Making new Rmarkdown file"
  cp ~/Documents/repos/templates/template.rmd "./$title.rmd" && sed -i '' "s/title/$title/" "$title.rmd"
}}

# map nr :read new_rmd #want to enter command mode to enter filename
map mr $Rscript -e "require(rmarkdown); render(\"$f\")"
